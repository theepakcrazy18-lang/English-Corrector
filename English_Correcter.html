 <!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>English Corrector - Classroom Edition</title>

<link href="https://fonts.googleapis.com/css2?family=Audiowide&display=swap" rel="stylesheet">

<style>
body{
    font-family:'Audiowide', cursive;
    background-image: url("https://i.ibb.co/5GZFG2q/classroom-bg.jpg");
    background-size: cover;
    background-position: center;
    backdrop-filter: blur(2px);
    color:#00faff;
    text-align:center;
    padding:20px;
}

/* Blackboard glass neon effect */
.container{
    width:90%;
    max-width:900px;
    margin:auto;
    padding:20px;
    border:2px solid #00eaff;
    border-radius:15px;
    box-shadow:0 0 25px #00eaff;
    background:rgba(0,0,0,0.65);
}

/* Notebook paper textarea */
textarea{
    width:95%;
    height:200px;
    padding:10px;
    border:2px solid #00eaff;
    border-radius:10px;
    background:#fefefe;
    color:#000;
    font-size:17px;
    background-image: repeating-linear-gradient(white,#f5f5f5 28px, #d4e1ff 29px);
    line-height:30px;
}

button{
    font-family:'Audiowide';
    padding:12px 20px;
    margin:8px;
    border:none;
    cursor:pointer;
    border-radius:8px;
    font-size:16px;
    background:#002f43;
    color:#00faff;
    box-shadow:0 0 10px #00eaff;
}
button:hover{
    background:#00eaff;
    color:#001f2f;
}

#output, #errors{
    margin-top:15px;
    padding:15px;
    border:2px solid #00eaff;
    border-radius:10px;
    box-shadow:0 0 15px #00eaff;
    background:#022123;
    text-align:left;
}

.error-highlight{
    color:#ff0044;
    font-weight:bold;
}
</style>
</head>

<body>

<h1>üìö English Corrector ‚Äî Classroom Neon Edition ‚ú®</h1>

<div class="container">

<textarea id="textInput" placeholder="Write or speak here..."></textarea><br>

<button onclick="btnClick(); checkGrammar()">Check Grammar</button>
<button onclick="btnClick(); startVoice()">üé§ Voice Input</button>
<button onclick="btnClick(); resetText()">Reset</button>
<button onclick="btnClick(); toggleMode()">Light/Dark</button>

<h3>‚úÖ Corrected Text</h3>
<div id="output"></div>

<h3>‚ùó Errors & Explanation</h3>
<div id="errors"></div>

</div>

<!-- Sounds -->
<audio id="btnSound" src="sounds/click.mp3"></audio>
<audio id="chalkSound" src="sounds/chalk.mp3"></audio>

<script>
// Button click sound
function btnClick() {
  document.getElementById("btnSound").play();
}

// Main Grammar Check with AI
async function checkGrammar() {
  document.getElementById("chalkSound").play();
  const input = document.getElementById("textInput").value.trim();
  if (!input) return;

  document.getElementById("output").innerHTML = "<i>Analyzing with AI...</i>";
  document.getElementById("errors").innerHTML = "";

  try {
    // --- AI Grammar via OpenAI ---
    const aiResponse = await fetch("https://api.openai.com/v1/chat/completions", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "Authorization": "Bearer YOUR_OPENAI_API_KEY"
      },
      body: JSON.stringify({
        model: "gpt-4o-mini",
        messages: [
          { role: "system", content: "You are a precise English grammar corrector. Return corrected text and explanations." },
          { role: "user", content: input }
        ]
      })
    });

    const data = await aiResponse.json();
    const aiText = data.choices[0].message.content;

    document.getElementById("output").innerHTML = aiText.split("\n\n")[0];
    document.getElementById("errors").innerHTML = "<pre>" + aiText.split("\n\n").slice(1).join("\n\n") + "</pre>";
  } catch (e) {
    console.error(e);
    // --- Fallback: LanguageTool ---
    fetch("https://api.languagetool.org/v2/check", {
      method: "POST",
      headers: { "Content-Type": "application/x-www-form-urlencoded" },
      body: "language=en-US&text=" + encodeURIComponent(input)
    })
    .then(res => res.json())
    .then(data => {
      let corrected = input;
      let errorHTML = "";
      data.matches.forEach((err, i) => {
        const wrong = input.substring(err.context.offset, err.context.offset + err.context.length);
        const suggestion = err.replacements.length > 0 ? err.replacements[0].value : wrong;
        corrected = corrected.replace(wrong, suggestion);
        errorHTML += `
          <p><b>Error ${i+1}:</b> <span class="error-highlight">${wrong}</span><br>
          <b>Suggestion:</b> ${suggestion}<br>
          <b>Explanation:</b> ${err.message}</p><hr>`;
      });
      document.getElementById("output").innerHTML = corrected;
      document.getElementById("errors").innerHTML = errorHTML || "<i>No mistakes! ‚≠ê Great work!</i>";
    });
  }
}

// Voice, Reset, Mode
function startVoice() {
  let r = new(window.SpeechRecognition || window.webkitSpeechRecognition)();
  r.lang = "en-US";
  r.onresult = e => document.getElementById("textInput").value += " " + e.results[0][0].transcript;
  r.start();
}

function resetText() {
  document.getElementById("textInput").value = "";
  document.getElementById("output").innerHTML = "";
  document.getElementById("errors").innerHTML = "";
}

function toggleMode() {
  document.body.style.filter = (document.body.style.filter == "invert(1)") ? "invert(0)" : "invert(1)";
}
</script>

</body>
</html>
